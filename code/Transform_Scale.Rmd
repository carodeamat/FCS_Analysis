---
title: "Pre-processing of FCS files: Arcsih Transformation"
author: "Carolina"
date: "2024-12-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Transformation

This is an R Markdown document to pre-process FCS files by applying transformation to parameter values. 

## Load packages and utilities
```{r}

library(tidyverse)
library(flowCore)
library(flowVS)
library(FlowSOM)
library(Rphenograph)
library(Rtsne)
library(umap)
library(ggcyto)
library(pheatmap)
library(viridis)
library(scales)
library(reshape2)

source("code/Preprocessing_Functions.R")



```

## Directories
The input directory (indir) is were all the data is store (fcs files/directory and metadata file)
The fcs directory (fcsdir) is where the FCS files are located.
The output directory (outdir) will contain the results of the analysis
The plotd directory (plotdir) will contain all the output images generated.


```{r}
# Set directories

indir <- "data/"
fcsdir <- "data/FCS/"
outdir <- "results/"
plotdir <- "results/plots"

```

## Read data

A csv file named "metadata.csv", containing the sample name (same as fcs file) as well as all the information for each files (e.g. mouseID, Treatment, Sex, Tissue, etc.) must be located in the working directory (root.dir).
The read.fcs function reads the metadata and identify the fcs files in the fcs directory to read them and create a flowset object. It will also print the fcs file names that are included in the flowset, and will inform of any excluded (present in fcsdir but not in metadata), or missing (in metadata, but not found in fcsdir) fcs file.

```{r}

metadata <- read.csv(paste(indir, "metatata.csv"), sep="")

fset <- read.fcs(fcs.dir.path=fcsdir,
                 metadata=metadata,
                 transform=FALSE,
                 downsample=NULL,
                 truncate.max=FALSE)

```


