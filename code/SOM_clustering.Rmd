---
title: "FlowSOM clustering"
author: "Carolina"
date: "2025-01-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}

# Load required packages
library(tidyverse)
#library(dplyr)
#library(flowCore)
#library(flowVS)
library(FlowSOM)
#library(Rphenograph)
library(umap)
#library(ggcyto)
#library(pheatmap)
#library(viridis)
#library(scales)
#library(SingleCellExperiment) #only for pseudotime analysis
#library(slingshot) #only for pseudotime analysis
#library(reshape2)
library(Rtsne)

seed <- 1234
set.seed(seed)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}

# Set directories
indir <- "data"
transfdir <- "data/Transformed_Data/"

# Read metadata and transformed expression data
metadata <- read.csv(file.path(indir, "metadata.csv"))
expr.df <- read.csv(file.path(transfdir, "TransfExprData.csv"), check.names=FALSE)

# Check the available markers that can be copied
for(column in colnames(expr.df)[-1]){
  cat(paste("\"", column, "\",", sep=""), "\n")
}

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


```{r}

# Select the markers to be used for clustering and dimension reduction.
sel.markers <- c(
"FceR1g", 
"CD56", 
"CD94", 
"GNLY", 
"CD39", 
"CD4", 
"CXCR6", 
"CD62L", 
"CD8", 
"GzmB", 
"CD319", 
"CD57", 
"CD161", 
"PD1", 
"CD16", 
"RORgt", 
"2B4", 
"Tbet"
)

#markers.use <- which(colnames(mat) %in% sel.markers)
# Create data list with expression matrix and metadata
data <- list(expr.mat = as.matrix(expr.df[,sel.markers]),
             metadata = data.frame(matrix(nrow = nrow(expr.df), ncol = 0)))

# Add metadata information
for (column in colnames(metadata)) {
  data$metadata <- cbind(data$metadata, metadata[match(expr.df$Sample, metadata[,1]),column])
  colnames(data$metadata)[ncol(data$metadata)] <- column
}

```

```{r}



```

